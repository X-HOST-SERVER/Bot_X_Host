import PhoneNumber from 'awesome-phonenumber'
import fetch from 'node-fetch'

const imagen1 = 'https://n.uguu.se/UDKnJnhh.jpg'

let handler = async (m, { conn, command }) => {
    let who = m.mentionedJid && m.mentionedJid[0]
        ? m.mentionedJid[0]
        : m.fromMe
        ? conn.user.jid
        : m.sender

    let pp = await conn.profilePictureUrl(who, 'image').catch(_ => imagen1)
    
    let user = global.db.data.users[who] || (global.db.data.users[who] = {
        premium: false,
        level: 0,
        cookies: 0,
        exp: 0,
        lastclaim: 0,
        registered: false,
        regTime: -1,
        age: 0,
        role: 'โญ ูุจุชุฏุฆ โญ'
    })

    let { premium, level, exp, registered, role } = user
    let username = await conn.getName(who)

    // ุฏูุฌ ุงูุฑุณุงูุฉ ุงูุฃูููุฉ ูุน ุงููุต ุงูููุงุฆู
    let noprem = `
๐ใ *ูุธุงู ุงูุณุญุฑ* ใ๐

๐ ุฌุงุฑู ุชุญููู ุงูุทุงูุฉ ุงูุณุญุฑูุฉ...
๐ ูุญุต ูุชุงุจ ุงูุบุฑูููุงุฑ...
๐ ูุฒุงููุฉ ูุน ุทุงูุฉ ุงููุณุชุฎุฏู...

โจโจโจ ๐ *ุชู ุงูุชูุนูู* ๐ โจโจโจ

*ุชู ูุชุญ ุงูุบุฑูููุงุฑ ุจูุฌุงุญ...*

๐ ใ ุบุฑูููุงุฑ ุจุณูุท ใ๐

๐ *ุงูุงุณู:* ${username}
๐ *ุงููุนุฑู:* @${who.replace(/@.+/, '')}
๐ *ูุณุฌู:* ${registered ? 'โ ูุนู' : 'โ ูุง'}

๐ *ูุนูููุงุช ุณุญุฑูุฉ:*
โก *ุงููุณุชูู:* ${level}
โจ *ุงูุฎุจุฑุฉ:* ${exp}
๐ *ุงูุฑุชุจุฉ:* ${role}
๐ *ูููุฒ:* โ ูุง

๐ *ุงููุชุงุจ:* ุบุฑูููุงุฑ ุนุงุฏู ูู ุตูุญุฉ ูุงุญุฏุฉ
๐ *ุงูุนูุตุฑ:* ุบูุฑ ูุนุฑูู

๐ ุงุณุชูุฑ ูู ุงูุชุทููุฑ ูุชูุชุญ ููู ุฌุฏูุฏุฉ...

๐ฉ๐ถ๐ซ๐ ๐
`.trim()

    let prem = `
๐ใ *ูุธุงู ุงูุณุญุฑ* ใ๐

๐ ุฌุงุฑู ุชุญููู ุงูุทุงูุฉ ุงูุณุญุฑูุฉ...
๐ ูุญุต ูุชุงุจ ุงูุบุฑูููุงุฑ...
๐ ูุฒุงููุฉ ูุน ุทุงูุฉ ุงููุณุชุฎุฏู...

โจโจโจ ๐ *ุชู ุงูุชูุนูู* ๐ โจโจโจ

*ุชู ูุชุญ ุงูุบุฑูููุงุฑ ุจูุฌุงุญ...*

๐ใ ๐๐๐๐๐ ๐๐๐๐: *ูููุนู* ใ๐

๐ ใ ุบุฑูููุงุฑ ุฃุณุทูุฑู - ูฅ ุตูุญุงุช ใโฏ๏ธ

๐ *ุงูุงุณู:* ${username}
๐ *ุงููุนุฑู:* @${who.replace(/@.+/, '')}
๐ *ูุณุฌู:* ${registered ? 'โ ูุนู' : 'โ ูุง'}
๐ *ุงูุฑุชุจุฉ:* ๐ฃ *ุฃุณุทูุฑุฉ ุดูุทุงููุฉ*

๐ *ุงูุทุงูุฉ ุงูุณุญุฑูุฉ:*
โก *ุงููุณุชูู:* ${level}
๐ *ุงูุฎุจุฑุฉ:* ${exp}
๐ช *ุงูุฑุชุจุฉ:* ${role}
๐ *ูููุฒ:* โ ููุนู

๐ *ุงููุชุงุจ:* ุบุฑูููุงุฑ ููุงูุญุฉ ุงูุณุญุฑ ูฅ ุตูุญุงุช
๐ฅ *ุงููุถุน:* โฆ *ุงูุชุญูู ุงููุธูู*
๐งฉ *ุงูุนูุตุฑ:* ุณูู ุดูุทุงูู & ููุงูุญุฉ ุงูุณุญุฑ

๐ *ููุงุฑุฉ ููุนูุฉ:* 
โ ใโก ุงูุฃุณุทูุฑุฉ ุงูุณูุฏุงุก โกใ
โณ ุชุณุจุจ ุถุฑุฑ ูุจูุฑ ููุฃุนุฏุงุก.

๐ ูุฐุง ุงููุณุชุฎุฏู ุชุฎุทู ุญุฏูุฏู... โ๏ธ

๐ฉ๐ถ๐ซ๐ ๐
`.trim()

    // ุชุญุฏูุฏ ุงููุต ุงูููุงุฆู ุญุณุจ ุญุงูุฉ ุงูุจุฑููููู
    let finalText = premium ? prem : noprem

    // ุฅุฑุณุงู ุงูุตูุฑุฉ ูุน ุงููุต ุงููุงูู ุฏูุนุฉ ูุงุญุฏุฉ
    await conn.sendFile(
        m.chat,
        pp,
        'grimorio.jpg',
        finalText,
        m,
        undefined,
        { mentions: [who] }
    )
}

handler.help = ['profile', 'ููู', 'ููุงุฑุงุชู', 'ูุฏุฑุงุชู']
handler.tags = ['xp']
handler.command = ['profile', 'perfil', 'ููู', 'ููุงุฑุงุชู', 'ูุฏุฑุงุชู']
handler.register = true
handler.group = true

export default handler